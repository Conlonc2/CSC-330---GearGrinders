{% extends 'template.html'%}
{%block title%} {{title}}{%endblock%}

{%block style%}
<style>
    body {
        height: 100%;
        background: -webkit-linear-gradient(left, #3931af, #00c6ff);
    }

    a {
        color: white;
        text-decoration: none;
    }

    li {
        margin: .5%;
    }

    .main-body {
        position: fixed;
        background-color: white;
        margin-left: 12%;
        height: 85%;
        width: 86%;
        padding: 1%;
        border-radius: 2%;
    }

    #side {
        margin-top: 1%;
        position: fixed;
        text-align: center;
        background-color: rgba(133, 127, 127, 0.8);
        width: 10%;
        height: 85%;
    }

    #bottom-view {
        border: 1px solid black;
        position: fixed;
        height: 40%;
        bottom: 0;
        left: 0;
        width: 84%;
        margin-bottom: 3%;
        margin-right: 1.5%;
        margin-left: 13%;

        padding: 1%;
        overflow-y: scroll;
    }

    #postings a {
        color: black;
        text-decoration: none;
    }

    .nav-tabs>li.active>a {
        color: #3c5a78;
        font-size: 16px;
    }

    .nav-tabs>li>a {
        color: #575757;
    }
</style>
{% endblock %}
{%block content%}
<div class="sidebar ml-2">
    <ul class="sidebar navbar-nav" id="side">
        <li class="nav-item active">
            <!--Playying with sidebar content-->
            <a class="nav-link" href="/scoobysnacks">
                <span>Error 404</span>
            </a>
        </li>
        {% if current_user.role != 'student'%}
        <li class="nav-item">
            <a href="{{url_for('createPosting')}}" class="nav-link">Create new Posting</a>
        </li>
        {% endif %}
        {% if current_user.role == 'faculty'%}
        <li class="nav-item">
            <a href="{{url_for('user_confirm')}}" class="nav-link">Validate a New Account</a>
        </li>
        <li class="nav-item">
            <a href="{{ url_for('admin_view') }}" class="nav-link">Admin Panel</a>
        </li>
        {% endif %}
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('login')}}">
                <span>Login</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('logout')}}">
                <span>Logout</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('registration')}}">
                <span>Registration</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('profile', user_id = current_user.id)}}">
                <span>Profile</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('posting',id=current_user.id)}}">
                <span>View Posting</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('testemail')}}">
                <span>Send Test Email</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{{url_for('landing')}}">
                <span>Landing Page</span>
            </a>
        </li>
    </ul>
</div>
<div class="main-body mt-3" style="overflow:hidden">
    <legend>Welcome {{current_user.email}}</legend>
    <div class="card-columns">
        <div class="card bg-primary">
            <div class="card-body text-center">
                <a href="#">
                    <h4 class="card-title">Messages<span class="badge">4</span></h4>
                </a>
                {% if newMessage%}
                <p class="card-text">{{newMessage}}</p>
                {% endif %}
            </div>
        </div>
        <div class="card bg-warning">
            <div class="card-body text-center">
                <a href="#">
                    <h4 class="card-title">New Postings <span class="badge badge-light">4</span></h4>
                </a>
            </div>
        </div>
        <div class="card">
            <div class="card-body text-center">
                <h4 class="card-title">Message of the Day</h4>
                <p class="card-text">{{Daily}}</p>
            </div>
        </div>
        <div class="rounded" id="bottom-view">
            <div class="col-md-6">
                <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab"
                            aria-controls="home" aria-selected="true">Postings</a>
                    </li>
                    {% if current_user.role == 'student' %}
                    <li class="nav-item">
                        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
                            aria-selected="false">Your Applications</a>
                    </li>
                    {% endif %}
                    {% if current_user.role == 'sponsor'%}
                    <li class="nav-item">
                        <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile"
                            aria-selected="false">Your Postings</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
            <div class="tab-content profile-tab" id='myTabContent'>
                <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                    <table class="table table-striped table-hover" id="postings">
                        <thead class="thead-dark">
                            <tr>
                                <th>Title</th>
                                <th>Location</th>
                                <th>Compensation</th>
                                <th>Type of Job</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for post in postings%}
                            <tr>
                                <td><a href="{{ url_for('posting', id=post[0]) }}"> {{post[3]}} </a></td>
                                <td> {{post[4]}} </td>
                                {% if post[8] == 0 %}
                                <td> No </td>
                                {% else %}
                                <td> Yes </td>
                                {% endif %}
                                <td> {{post[9]}} </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                    <table class="table">
                        <table class="table table-sm table-bordered table-hover table-striped" id="postings">
                            <thead class="thead-dark">
                                <tr>
                                    <th>Title</th>
                                    <th>Location</th>
                                    <th>Compensation</th>
                                    <th>Type of Job</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for app in applied%}
                                <tr>
                                    <td><a href="{{ url_for('posting', id=app[0]) }}"> {{app[3]}} </a></td>
                                    <td> {{app[4]}} </td>
                                    {% if app[8] == 0 %}
                                    <td> No </td>
                                    {% else %}
                                    <td> Yes </td>
                                    {% endif %}
                                    <td> {{app[9]}} </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}